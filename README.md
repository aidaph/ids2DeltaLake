# ids2DeltaLake

This package provide the tools to create a first prototype where the events generated by the IDS Snort are stored in the Hadoop storage using the Delta Lake format. This techniques are deployed in a distributed and high-performance way. 

* This is the first version of the prototype, it is a WIP project. 

## Type of events in Snort

The events in Snort are generated following [the output modules of the docs](http://manual-snort-org.s3-website-us-east-1.amazonaws.com/node21.html). The fastest way to generate the logs is the configuration of Unified 2 format. U2 is a binary format used to catch all the events that travels through the network traffic. Json is one of the most common format used to generate the alerts. The result is a full capture between U2 log events and json alerts.  


The type of data in Snort is organized in event and packet. First of all, a schema is defined as below:

event:
- impact
- generator-id
- protocol
- dport-icode
- signature-revision
- classification-id
- signature-id
- sensor-id
- impact-flag
- sport-itype
- priority
- event-second
- pad2
- destination-ip
- event-id
- mpls-label
- vlan-id
- source-ip
- event-microsecond
- blocked

packet:
- type
- packet-second
- linktype
- sensor-id
- packet-microsecond
- event-second
- length
- data
- event-id

## Usage
Install it using ` python setup.py install`.

Export the JAVA_HOME variable before using the program. 

Create the parquet file in hadoop:
```
/usr/local/bin/u2toparquet /path/to/snortU2File/snort.u2.1235677 /user/hadoop/parquet/snort_alerts_test.parquet
```

See if the file was created in hadoop:
```
hadoop fs -ls /user/hadoop/parquet/
```

